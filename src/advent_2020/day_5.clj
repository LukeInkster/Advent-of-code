(ns advent-2020.day-5
  (:require [clojure.string :as string]))


(defn seat-ids
  [input]
  (let [binary-tickets (map (partial map {\F 0 \B 1 \L 0 \R 1}) (string/split-lines input))]
    (map (fn [bits]
           (reduce + (map-indexed (fn [idx bit]
                                    (* bit (Math/pow 2 idx)))
                                  (reverse bits))))
         binary-tickets)))


(defn part-1
  [input]
  (apply max (seat-ids input)))


(defn part-2
  [input]
  (loop [[a & more] (sort (seat-ids input))]
    (if (= (inc a) (first more))
      (recur more)
      (inc a))))


(def small-input
  "FBFBBFFRLR")


(def test-input
  "BFFFBBFRRR\nFFFBBBFRRR\nBBFFBBFRLL")


(def large-input
  "FFBFBBBRLR\nBBFFBFFRRR\nBFFFFBBRRR\nFFBFFBBLRR\nFFBFBFBLLL\nFFBFFBFLRR\nBFFFBBBLLR\nFFBFBFFRLR\nFFBFFFBRRR\nFFBFFFFRRL\nBFFBBFFLRL\nFFFBFFBLRR\nFBBFBFFRLR\nBFFFBFBRLR\nBFBFFBBRLR\nFFBBFBBLRR\nBFBBBFBRLR\nFFBBBFBRRL\nFFBFBBBRRR\nBFBBBBFRLL\nFBBFFFBRRR\nBFFBFBFRRR\nFFBFBBBLRL\nFBFFFFBLLR\nBBFFBFBRLL\nFBBBFFBLRL\nFBBBFFFRRR\nBFBFFBFRLR\nBFFFFBBLLL\nFBFFBBFRLR\nBFBBBBBLLR\nFFFFBBFLRR\nFBFBFBFRLR\nFBFFBFFLRR\nFFBFFBFRRR\nBFFBFBFRLL\nBFFFBBBLRR\nFFBBFFFLLR\nFBBBFBBLRR\nFFBBFBFRRL\nBFFBFFBRLL\nFBFFFBBLLR\nBFFFBFBLRL\nFFFBFBBRRL\nFBBBFBBRLL\nBFFBBBFRLL\nFBFFFFBLRR\nFFFBBBBLRR\nFFBFFBBLLL\nFBFBFBBRRL\nFFFBFBFRLR\nFBBFFFFRRR\nBFFFBBBRLR\nFBBBBFFLRR\nFFFFBBFLLR\nBFFBBBFRRR\nFBBBFFBRLL\nFBBBFBFLLR\nFBFBBFFRRL\nFFFBBFFLLR\nFFBFBFFLRL\nBFBBBFFRRL\nBFFBFBFRRL\nFFFBFBBLLL\nBFFBFFBLLR\nFBFBBFFLLL\nFFBBFBFLRR\nFFFBBBFRLR\nFBBBFBFRLL\nFBBBBBFLRR\nFFBFBFBRLR\nBBFFFFBRLR\nBFFBFBBRRL\nFBFFFFBRLL\nFFBFBFBLRR\nFBBBBFFRRR\nFBFBBBFLRL\nFBBBFFFLLL\nBFBFBFFRLL\nFBFFFBFLLR\nBFBFFBFLRL\nBFBBBFBLRR\nFBBFFBBRLR\nBFFFBBBRLL\nFBFBBBFLLL\nBFFFBFBLRR\nBFBBBFFRLR\nFFBBFFFRLL\nFFFBFBFRRL\nFBBFBFBLLR\nFBFFBFFLRL\nFBBFFBBLLR\nFBBBFBBRLR\nFBBBFBBLLR\nFBBFBBBLLL\nBFFFFBBRRL\nFBBFFBBRRR\nBFBFFBBLLR\nFFBBBBFLLR\nFFBFBFFLRR\nBBFFFBFRLL\nFFBFBBBLLL\nBFFFFBFRRL\nFBFBBBBLLL\nBFBBFFBLRR\nBFBBBFBRLL\nFBFFFFFLLL\nFBFBBFFLRL\nFFFBBFBLRL\nBFFFBFBLLR\nFBFBFFFRLL\nBBFFBFFLLL\nFFFFBBFLLL\nBFBBFBBLRR\nBFBBFBBRLR\nBFBFFFBLLL\nFBBBBFBRLL\nFFBFBBBLRR\nFFFBFBBLRL\nBFBFFBBRLL\nBFBFBBBRLL\nFFBFBBBRRL\nFFFBBBBRLR\nFFBBBBFLLL\nFBFBFBFRLL\nBFBFBBBLRL\nFFBBFFBRLL\nBFFBBFBRLR\nFFBBBBFLRR\nFFFBBBFLLL\nFFBFBBFLRL\nBFFBBFFLRR\nFFFFBBBLLL\nBFBFFFFRRL\nFBFFBBBRRR\nFBBFFBFRRR\nBFFFBFFRRR\nFFBBBFBRLL\nBBFFFBBLLL\nFFFFBBBRRR\nFFFBBFBRRL\nBBFFFBBLRR\nFBBFFFFLLR\nBFBFBBBRLR\nFFBFFBFRLR\nBFBFBFBLRR\nFBBFFBFLLL\nFBFBBFBLLR\nFBFFBBFRRR\nBFFFBBFRLR\nBFFFFFFRRR\nFFFBFFFLRR\nFBFBBFBRLR\nFFFBFBFLRL\nFFFBFFBLRL\nBFBFBFBRRR\nFFFBFFBRRL\nFFBBFFBRLR\nBFFBBFBLLR\nFFBFFFFLLR\nFBBBBBFLRL\nFBBBBFFLRL\nBFBFFBFLRR\nFFFBBBBLLL\nFFFBBFBLRR\nBFBBBFFLLR\nFBFBBFFLRR\nBBFFFBFRRR\nFBFBBFBLRL\nFFBBFFFLRL\nBFBFBFFLRR\nBFBFBFBRLL\nFBFBBBFLRR\nFBFFFFFLRR\nBFFFBBBRRL\nBFBBFFBRRR\nBBFFFBFLRL\nBFFBFFFRLL\nBBFFFBFLRR\nBFFBFBBRRR\nFBFFFBFLRL\nFBFBFBBLLR\nFFFBBFBRLR\nBFBBBFFRRR\nFBFBFBFRRL\nFBFFBFBLLR\nBFFBFBFLRL\nFBBBBFBLLL\nFFFBFBBLLR\nBFBFFFFRLR\nFBBBBBBLLL\nFBBBBFBLLR\nFFBFBBFRLL\nBFBBFFFLRL\nFFFBFFBLLL\nBFBFFFBLRL\nFBBBBFFRLL\nBFBBFFFRRL\nBFBBBBFRRR\nBFBBBBFLLL\nBFFBFBBLLL\nFBFBFFFRRR\nBFBBFFFRLL\nFBBFBBBRRR\nBFFFFFBLRL\nFBFFFBFLRR\nFBFBFBBLLL\nBFBBFFBRLL\nBFFBBFFRRL\nFBFBFFFLLR\nFBFFFBBRRL\nBFBFBBFRRL\nBBFFFFFLLR\nBFBFBFFRRR\nFFBFFFFLRL\nFBBBFBBLRL\nFFBBBFFLRR\nFBBBBFBRRL\nFFFBBBFRRL\nBFBFBFFLLL\nBFFBFBFRLR\nBFBBFBFRLR\nFBFBFBBRLL\nFBFFBBBRRL\nBBFFFFBLRR\nBFFFFFBRLR\nFBBFFBFLRL\nBFBFFBFRLL\nBFFFBBFLRL\nFBBBFBFRRR\nBBFFFFFLLL\nFBFBBFBRLL\nBFBFBFBLLL\nFBBFFBFRLR\nFBBBFBFLRR\nFBFFFFFLLR\nBBFFBBFLLL\nFFBFBBFLRR\nFFBBBBFLRL\nBFFFFBBLRL\nBFFFFFBRRL\nFBFFFFBRLR\nFFBBFBBRRR\nFFBFBBFLLR\nFBFBBBBLLR\nBFFFBFFLRR\nBFFBBBFRRL\nFBBBBBBRRL\nFBBBBFBRLR\nBFBFBBFLLL\nBFFBBBFRLR\nBFBBFBBRLL\nFBBBBBBRLL\nFFBBFFFRLR\nFFFBBFFRLL\nFBFBBBFRLL\nFBBFFBFLRR\nBFBBFFBRLR\nBFFBBFBRRR\nFFBFBBFRRL\nFFBFBBFLLL\nFFFBBFBLLL\nFBFFFBFRLL\nFFBBBFFRLR\nFFFBFBBLRR\nFBBFFBFLLR\nBBFFFBFLLL\nBBFFFBBRLR\nFFBBBFFLRL\nFBFBBFBRRR\nBFFFBBFLRR\nFBBBFFFRLL\nBFFBFFBRRL\nFBBBBBBLRR\nBFFFBFFRRL\nFFBFBBBRLL\nFBFBBFFLLR\nBFFFBBBLLL\nBFBFFFFLLR\nFBBBBBBLLR\nFFBBFBFRRR\nFBFBFBFLLL\nBFBFBFBLLR\nFFBBFBBLRL\nFFFFBBBLRR\nBFFBFBBRLR\nBFFBBBBRRL\nFBFFBFFLLL\nBFBBBBBRRR\nBFBFFFFLRL\nFFFBBBBRLL\nBFFFBFFLLR\nFBBFBFFLRR\nBFBFFBFLLR\nFBBBBFBRRR\nFFBFFBBRRR\nFFBFFFFRRR\nFBBFBFBLRR\nBFBFBBFRRR\nFBFFFBFRRR\nFBFFBFFRRR\nBFFFBBFLLL\nBFBFBBFLRR\nBFFBFFFRLR\nFFFBFFBLLR\nFFFBFFFLLR\nFBBBBBFRRL\nFBBFBBFRRL\nBFFBFFBRLR\nBBFFBFFRLR\nFFBBFFFRRR\nFBFFFFFRRR\nBBFFFBBLLR\nBBFFBBFLRL\nFFBBBBBLLR\nFFBFBBFRLR\nBFFBFFBRRR\nBFBFFFBRLL\nFFBBBBFRLR\nBFFFFFFLRL\nBFBBFBBRRL\nBFFBBFBLRR\nFFFBBBFLRL\nBFBBFBBRRR\nFFBBFFFLLL\nFFFBBFFRLR\nFBFBFFBLRR\nBFFFFBFRRR\nBBFFBFBLLL\nBFFFFBFLRL\nBFFBBBFLLR\nBFFFBFFRLR\nFBFBBBBRLL\nBBFFBFFRLL\nFBFFBBFLRL\nFFBFFBBRRL\nBFFFFBBRLL\nFFFFBBBLRL\nFFBFBFBLLR\nBFBFBBBLLL\nFBBFFBBLRR\nFFBBBBFRRR\nFFBBBFFLLL\nBFBBBFBLLR\nFFFFBBFRRR\nBFFBBBBRRR\nFFBBFFBLLL\nFBFFFFFLRL\nFBFBBBFLLR\nFFBBFFFLRR\nFBFBFBFLRR\nBFFBFBBLRL\nFBFFFFBLLL\nFFBBBBBRRL\nFBBBBFFLLL\nBBFFFFBLLL\nBFFBBFBRRL\nFFBBBFFLLR\nFBBFBFBRRR\nBBFFFBBRRR\nFBFBFFBRLL\nFBFFBFBLRR\nBFBFFBBRRL\nFBBFBBFLRR\nBBFFFFBLRL\nBFFBBBBRLR\nBFBFFBBRRR\nFBBFFFBRLR\nFBBFBBBLRL\nFBFBFBFRRR\nFFBFFFBRLR\nFFBBFBFLRL\nFFBBBBFRRL\nFFBBBFBLRR\nBFFBBFFLLR\nFFFFBBBRLL\nBFBBFBBLLR\nBBFFFFBRLL\nFBBFFFFLRR\nBFFBFBFLLR\nFBBBFBFLRL\nFBBFFFFLLL\nBFFBFFFLRR\nBFBBFBFLRR\nBFFBFBBRLL\nFBFFBBBLRL\nFBBBFFBLLL\nFBBBFFFLRL\nBFFBBBBLLL\nBFFFBFFLLL\nFFFBFFBRRR\nFFBFFFBLRL\nFBBFBBBLRR\nFFFBBFBRRR\nFBBFBFFLLL\nBFBFBBFLRL\nBFFBFFFRRL\nBFBFBBBLRR\nFFBFFBBRLL\nFFBFBFFLLR\nBFBBBBBRRL\nFBFFBFFRLR\nBBFFBFBLRL\nFFFBBFFLRR\nBBFFBBFLLR\nFFFBBBBRRR\nFFBFFBFLLR\nBFFFFBFRLR\nFFBFFFFLRR\nBBFFFFFRLR\nFBFBBBBLRL\nFBFFBBFRRL\nBFBBFBFRRR\nFBBBBFFLLR\nFFBBBFFRRR\nFBBFBFBRRL\nBFBBFBBLLL\nBBFFFBBRLL\nFBBFBFFRRL\nFBBBBBFLLL\nBFBBBFFLRR\nBFFFFFFRRL\nBBFFFBFRLR\nBFBFFFBLRR\nFBFBFFFLRR\nBBFFFBBLRL\nBFFFFBBRLR\nBFFBFBBLRR\nBFBFFFBRLR\nBFFFFBBLRR\nBBFFFFBRRL\nBFBBBFBRRR\nBFBBBBBLRL\nFFFBBBFLRR\nBFFBBFFRLL\nFBFFBFBRRR\nFFFBBFFLLL\nFFBFFBFRRL\nFBFFBFFRLL\nBFBBBFFLLL\nBFFFBFBRRL\nFFFBFFFRRL\nFFFBFBFLLL\nFFFBBBBRRL\nBFBBFFBRRL\nBFBFFBFLLL\nBBFFFBFRRL\nBFBFBFFRLR\nFFFBFBBRLR\nBFBFBFBLRL\nBFFBFFFLLR\nFBFBBBFRRL\nFBFBBBBRLR\nBFFBBBBLRL\nBFBBFBFLLL\nFFFBFFBRLL\nFBBFFFBLRR\nFFFFBBFRLR\nBFBFFFFRRR\nBFBBFBFLRL\nFFBFBFFRRR\nBFBBBBBRLL\nFBFFFFFRLR\nFBFBFFBLLL\nFFBBFFBRRR\nFFFBBBFRRR\nFBFFBBFLLR\nBFBBFFBLLL\nBFBBFFFRRR\nFBFBBFFRLL\nFFBBBBBLRR\nFBFBFBBLRR\nFBFFFBFRRL\nFBBFFFBRRL\nBFFBBBBLLR\nBFBBFFFRLR\nFBBBFFFLRR\nFBBFBBBRLR\nFFFBFBFLLR\nFFBFBFBRRR\nBFBFBBBRRL\nFBFFBFFLLR\nFFFBFFBRLR\nBFBFBBFLLR\nFBBFFFBLLL\nFBFFBFBRLL\nBFFFBBFRRL\nFBBBBBFRRR\nBBFFFFFRRL\nBFBFFFFLLL\nFBFFFFBRRR\nBFFFFFFRLR\nBFFBFFBLRL\nBFBBFBFRRL\nBFBBFFFLLL\nFFBBBFBRLR\nFFFBFBBRLL\nFBFFFBBLRR\nBFFFFFBRRR\nBBFFBFBRRL\nFFFFBBFRLL\nBFBBBBFRLR\nBFBBBFBRRL\nBFBFBFBRLR\nFFBFBFBLRL\nBFBFFFFRLL\nFBFFBBBRLR\nFBFBFFBLLR\nFFBFFFBLLR\nFBFBBBBRRR\nFFFBBBFLLR\nBBFFFFFRRR\nFBBFBBFRRR\nFBBFBBBRLL\nBFFFFFBLLR\nBFFFBBFRRR\nFBFFFFBLRL\nFFFBFBFRRR\nFFBFFFBRLL\nFBBBBBFLLR\nFFBFFFBLLL\nBFFFFBBLLR\nFBFFBFBLRL\nFFBBFFBRRL\nBFFBFFBLLL\nFBBBFBBRRR\nBFFBBFBLLL\nFBFBBBFRLR\nFFBBFBBLLL\nFFBBFFBLRR\nBFFFFFFLRR\nFFBFFBBRLR\nFBBBBBFRLL\nFFBBFFBLLR\nFBFFBBBLLR\nFBFBFFBRRL\nBFFBBBFLLL\nFFBFFFFRLR\nFBFBFBBRLR\nFBBFFFBLRL\nFFBFBFBRRL\nFBFFFBFRLR\nFBBBBBBLRL\nFFFFBBBRRL\nBFBBBBFLLR\nBBFFBFBRLR\nFBBBBFFRLR\nBFFFFFFRLL\nFBBFFBBLRL\nFBFBFBBLRL\nFBFBFBBRRR\nBFBBBBFRRL\nBFBBBBBRLR\nFFFBBFBRLL\nFBBFFBBRLL\nBFFFFFFLLL\nFBBBFBFLLL\nFBBFBBFLRL\nFFBBBBBRRR\nBFBFFBBLRL\nBFFBFBBLLR\nFBBBBFBLRR\nBFBBFFBLRL\nBBFFFFBLLR\nBFFFBFBRLL\nFBBBBFBLRL\nBFBFBFFLLR\nFBBBFBBLLL\nFBBFFBFRRL\nBBFFBFFLRR\nFBFBFBFLLR\nFBBFBBFLLL\nFBFFBFFRRL\nFFBBBBBRLR\nFBBBFFBLRR\nFBBBBBFRLR\nFBFBBBBRRL\nBBFFFBFLLR\nFBFBBFBRRL\nBFFFFFBLRR\nFFFBFFFLLL\nFBFBFFFLRL\nFFBFFBFLRL\nBFBFFBFRRR\nFBFBFFBLRL\nFFBFFBBLRL\nFFBBFBFLLR\nFBFBBFFRLR\nFFBFBFFRLL\nBFBFFBFRRL\nBFFFFFBRLL\nBFBBBFFLRL\nBBFFBFFLLR\nBFFFBBFLLR\nBFFBBBFLRR\nFBBFFFFRRL\nFFBBBFBLLR\nBFBBBFBLLL\nBFFFFFFLLR\nFBBFBBFLLR\nFBFBBFBLRR\nFFBFBBFRRR\nBFFBBFFRLR\nBFFBBBFLRL\nFBFFBFBRLR\nBFBBFFBLLR\nBFBFFFFLRR\nFFBBBBBRLL\nFBBBFBBRRL\nBFFBBFFRRR\nFBFFBBBRLL\nFFBFFFFRLL\nBFBFBFBRRL\nFBBFFBFRLL\nBFFFBFFRLL\nBFBBBBBLLL\nFBBBFFBLLR\nFFFBFBFLRR\nFFFBBFFRRL\nFFBBBFBLRL\nBFFBFBFLLL\nFFBBBFFRLL\nFFBFFBFLLL\nFBBBFBFRLR\nFFBBFBFLLL\nBFBBFFFLLR\nFBBBFFFRLR\nFBFFFFBRRL\nFFFBFBBRRR\nFBFFBBFLRR\nBBFFFFFRLL\nFBFFBBBLRR\nFBFBFFBRRR\nFBFFFFFRLL\nFFBFFFBRRL\nFFFFBBFLRL\nBFBBFBBLRL\nFFBFFBBLLR\nBFBFBBBLLR\nFFBBBFBLLL\nBBFFBFBLLR\nFFFBFFFLRL\nFBFFFBBLRL\nFBFFFBBRLL\nBFFFBFFLRL\nFBBBBBBRRR\nFBFFFBBLLL\nFFFBFFFRLR\nFBBFBBBRRL\nBFFBBFBRLL\nFFFBBFBLLR\nFBBBFFBRRL\nBFBFBBFRLR\nFBFFBFBLLL\nBFBFFFBLLR\nFFFBBBFRLL\nFBFFBBFLLL\nFBBBFFFLLR\nFBBBFBFRRL\nBFBFFFBRRR\nBFBFBBFRLL\nBFFBFFFLRL\nBFFBBBBRLL\nBBFFBFFRRL\nBFBFBFFRRL\nFBBFBBFRLL\nFFFBBBBLLR\nBFFBFFFRRR\nFFFFBBBLLR\nBFFBBFBLRL\nFBBFFFFLRL\nFBBFBFBLRL\nFBFFFBFLLL\nBFFFFBFLRR\nFBFFBBFRLL\nFFBBFBBRLR\nBFBBBBFLRL\nFFFBFBFRLL\nFBBFFFBRLL\nFFBFFBFRLL\nBFFBFBFLRR\nFFFFBBBRLR\nBFBBFFFLRR\nFBFBFBFLRL\nFFBBBBFRLL\nBBFFBFBLRR\nFFBBBFBRRR\nBFBBBFBLRL\nBFFFFFBLLL\nBFFBFFFLLL\nFBBBBFFRRL\nFFBBFFFRRL\nFBBFFBBLLL\nBBFFBFBRRR\nFBFBFFFRLR\nFFBFFFBLRR\nFBFBBFBLLL\nBFFBBBBLRR\nBFFBBFFLLL\nFFBFFFFLLL\nBBFFFFFLRR\nFBBFBFBRLR\nBBFFFBBRRL\nBFFFFBFLLR\nFBBFBFFRLL\nBFFBFFBLRR\nFFFBFFFRRR\nFBFFBFBRRL\nFBBFBFFRRR\nBFBBBBFLRR\nFBBBFFFRRL\nFFBBFBBLLR\nFFFFBBFRRL\nFFBBFBBRRL\nBFFFBBBLRL\nFBBBFFBRRR\nFBBFBFBLLL\nFBFBFFBRLR\nBFFFBBFRLL\nBBFFFFFLRL\nBFFFBFBLLL\nFFBFBFFRRL\nFBFFFBBRRR\nFFBBFFBLRL\nFBFBBBFRRR\nFFBBFBBRLL\nFFBBBBBLLL\nFFBFBFFLLL\nBFBFFBBLLL\nFFFBBBBLRL\nBBFFBFFLRL\nFBFFFFFRRL\nFFBFBBBLLR\nFBBFFFFRLR\nFFBBBFFRRL\nFBBFBFFLLR\nFBFBFFFRRL\nFBBFFFFRLL\nBFBBBFFRLL\nBBFFFFBRRR\nBFBFBBBRRR\nFBFFFBBRLR\nBFFFFBFRLL\nFFBFBFBRLL\nFBBFBFBRLL\nFBBFBBFRLR\nFFFBFFFRLL\nBFBBFBFRLL\nFBBBFFBRLR\nFFFBBFFRRR\nFBBFFFBLLR\nFBBBBBBRLR\nFFBBBBBLRL\nFBBFBFFLRL\nBFBFFFBRRL\nFBFBFFFLLL\nFFBBFBFRLL\nBFBFFBBLRR\nFBFFBBBLLL\nFBFBBFFRRR\nBFFFBBBRRR\nBFBBBBBLRR\nFBBFBBBLLR\nFFFBBFFLRL\nFBBFFBBRRL\nFFBBFBFRLR\nBFBFBFFLRL\nBFBBFBFLLR\nFBFBBBBLRR\nBFFFFBFLLL")
