(ns advent-2020.day-3
  (:require [clojure.string :as string]))


(defn part-1
  [input [right down]]
  (let [lines (string/split-lines input)
        width (count (first lines))]
    (->> (take-nth down lines)
         (keep-indexed (fn [idx line] (when (= \# (.charAt line (mod (* idx right) width))) 1)))
         (count))))


(defn part-2
  [input slopes]
  (apply * (map (partial part-1 input) slopes)))


(def slopes [[1 1] [3 1] [5 1] [7 1] [1 2]])


(def input
  ".....#............#....#####.##\n.#.#....#......#....##.........\n......#.#.#.....###.#.#........\n......#...#.....#####....#..##.\n...#............##...###.##....\n#.....#...#....#......##....##.\n#...#.#....#..#..##.##...#.....\n.......#..........#..#..#.#....\n.#.....#.#.......#..#...#....#.\n#..#.##.#..................###.\n...#.#.##...##.###.....#..#...#\n..#.#...#............#.......#.\n#..#.#..#.#....#...#.#.....#..#\n#......##....#..#.#.#........#.\n....#..#.#.#.##............#..#\n....#..#..#...#.#.##......#...#\n##...#...........#.....###.#...\n..#...#.#...#.#.....#....##.##.\n....##...##.#....#.....#.##....\n#........##......#......#.#.#.#\n....#.#.#.........##......#....\n.#......#...#.....##..#....#..#\n....#..#.#.....#..........#..#.\n..##...#..##................#.#\n.....#....#.#..#......#........\n........#..#.#......#.#........\n.....#.#....##.###....#...#....\n...##.#.......#....###..#......\n............##.#..#...#........\n#..###..#.....#.####...........\n.......##.....#......#......#..\n#........##..#.....##.......#.#\n#.##...#...#...#......##..#.#.#\n......#....##.#.#...#...##....#\n#..#....##.#......#.......##...\n.#..........#..........#....#.#\n#.....##......##....#..........\n..#.#.....#.#...#........#.....\n...#........#..#..#.##..##.....\n......###.....#..#...#.###...##\n.##.##.......#.......###...#...\n#.#..#.#.#....#.....###..#...##\n......#.##..........#.......##.\n#..#.#.........#.....##...##...\n..#...#....#....###.#......#...\n.....#..#.######.....#..#.#....\n..#.#.....#.....##.#....##.#.##\n...#.#.#....#....##..#..#.#.##.\n...........#.#...#..#..####....\n.........#####.#.#.#...#.##.#..\n.......#...#......#.##.#.##....\n....#.....#.....###..........#.\n.#.###....##.#..#..........#...\n#...#.........##.....####....#.\n##....##...#..........#........\n...#.#.#.#....#..........#.....\n.......#....#......##.......#..\n.#.#..#.........#.#.##....#....\n..#.............#..##.#.##..###\n.#.##..............#..#..##..#.\n..##.#..#......#...##..#.##...#\n......#..#....#....#....##..#..\n...#...##.............#..###...\n...##....#.#.##........#.....##\n....#.#.......#..###..#....####\n#...#...##..#.####..#...##....#\n.......#..#.##..#...#.#........\n###.#......#..##..#......#.##..\n#....#............#.....#......\n..##...#..##......#..#....#....\n.#..##...#....#.#...#...#..#..#\n........#....###...#..##..###.#\n.........#....#....#..#.#.#...#\n.#....###.##...#.#...........##\n..#..#.#..#.#.##..#...##.......\n##..#.#.#....#...#..#..........\n#..#.......#....#..##...####...\n............#.#..........##.##.\n#...#..#.#....#..#.#....##.....\n......#...#...#.##............#\n#.....##..###..#.#..#.#.##..#.#\n#..#.#..#......#.......##.#....\n##..#.#..#...#......#.##...###.\n.#....#..............#....#.#..\n..#.#..##....#....#..##........\n.#.#...#..#.....#.#..##........\n.....#..#.#......#....#.#..#.#.\n....#.###...###.#.#.....#......\n...........#.#....##....##.....\n..#..#.##..........#...#...#..#\n.....#.###.#..........#........\n....#....##........###...#.....\n.#.....##.......#....#..##..###\n#.....#...............##......#\n#..#.#..#.#.#.....#.#...#......\n.##.###...#....#..........##...\n.#.......#.....................\n.#.#....#...##..#...#...##.....\n.#.#...#.......#.......#...#...\n....#.#..#.#..#...#....##......\n....##.....#.##....#.##..##..##\n..#............#...###.##..#...\n.#..#.........#.##....#....#..#\n.#..##..#..#........#.#.##.#.##\n.###.#...#...............#...#.\n...#.##.##.#......#...#....##.#\n#......##.......##...###....#.#\n#..##.....##......#.#.##....#.#\n...#.#....#.#.#...........##..#\n#.....##......##.#..........##.\n###....#.#...#.#..####.........\n.##.#.#...##..#.....#..#...#...\n#.....#.#......#..........#.#..\n..###.##.#...................#.\n#.............#..#........#.##.\n#.#.#.#..#.....##..##.#....#...\n...#...#..#...#..##..##........\n...##...##..#...##...........#.\n.####..#.#.#.##.#.......#......\n...#....#.......#......#.......\n.....#.#...#...#..##..#..#.....\n......#.....###.#..#..#.#..###.\n.#....#....#..#..##.....##...#.\n.#.............##.###.#...#.#..\n#..#..#......#.###............#\n##.#..##....#..........#.#.#...\n......#........#...#.......##..\n....#.#..#..........#.....#.#..\n...#..#...#.#...#........#.....\n.....##...#....#.........##.##.\n....#...#...#.##.##...#....#...\n.#..#.....##......#..#.#..#....\n........##...##.##......#.#.#.#\n.................#..#.....##.#.\n...#.....#...#.........#..#.#.#\n....##.#.....#........#...#..#.\n#...............#..#.....#...#.\n.....#..#....#...#.####.#.#....\n####.#..#.##...#....#...##.....\n#...##..#...####..#....#.#...#.\n..#.......#.##..##...#.#.......\n...........##.......#....#..#..\n#.##....#...#.....#....##......\n....##.#.......#..#...##.......\n...#.........##.#..#......#.###\n.#..#..#....#.#.##....###..###.\n....#.#........##........##....\n....########....#.#.#.###.#...#\n...#.###.###.##......##.......#\n.#...#.###.......#..........#..\n..#..##.........#............#.\n.......##.#...#...##...#...#..#\n#.##....#.#...#.....#..#.#.....\n..#........#..#.#.#.#....#.##..\n...#...#.#.........#...#.#..##.\n#....#......#.#...........#..##\n...#.#.#..#...##...#...#...#...\n###..........#.#..........#....\n..#....#.#.#.#............#.#..\n....#...#..###...#.#....#......\n#...........####......##.#.....\n..#..##.#...#.....#..#.......##\n#.....#..###.....#...##..##....\n##..###..##...........#.#...#..\n.....#......#..............#...\n#..#.##.###.......#.......#...#\n#........#....##......#.#......\n.#.#.#...#.......#........#.##.\n#..#..##.....#...#.#.#.#..###..\n.#.#....#..#..#.#....##.#.#....\n..#.#.........####.#...#.#.###.\n....##........##....#........#.\n................#..........#...\n..#...................###.##..#\n.........#..#..#.#...#....#.#.#\n......#.....###.....#.#..#...#.\n.#.#.....#..##............##...\n...##......##.#....#...........\n...##..##..###.#...##..........\n....###...#..#.#......#......#.\n....##..............#..#..#.#..\n####.......#...##.##..#.#......\n.#......#.....#....###..#....#.\n.#.......#...##...#..##.#......\n#.......#.......#.#....#.#.#..#\n........#..#..#............##.#\n#.#...#.#..##..#.......##..#...\n...#....#...#..........##..#...\n#.#...#.##....###......##....#.\n#..#...###........#..#....#..#.\n#....#....###....#..#.......#..\n....#.#........#.............#.\n.#.##........##...#...#...#...#\n#.....##.....#.......#.#.#.....\n.#.##..........##..#....#......\n.#..##.##.#...##....#.#....##..\n........#.#.##.#....#.#..#....#\n..#...........................#\n.#...........#....#....#.#..#..\n........##...........#...#...#.\n..#.....#..#......#..##.......#\n..#....###..###...#.#.#..#....#\n#..#.#...#......##......#......\n...........#...##..##....##....\n#.#......###..#.....#.......#.#\n#.....#....#....#.#...#...#....\n....#...#.......#....##.#..#...\n.####..##......##.#........#..#\n..###..#.#.....#...........##..\n..##.#.#..#....#..#..#.........\n..........#.#.#####...#........\n.###......##.#....#........#...\n.....#..#..#.#..#.........#....\n..#....#...#...#...##..........\n....#..##.#.........##.#..##...\n##.####..#...#.#...#.....#..###\n..#..#...#...#.....##....#..#.#\n#..##..#.....#....#.#.....##..#\n...#...........##.....#......#.\n......#...#.....#.#..###.......\n.........#.....###.##..#...#...\n.#...#.##...#..........#.#..##.\n......#.......##.....#.....##..\n........###..........#...#.....\n##.......###..###...##...#.....\n#.#.............#..#..#.#......\n..##........#.###.....#....##..\n......#...#......#....##......#\n..#.....#...##...#.......#..#..\n..#.###..##.##...#....#...##.#.\n........##...#..#.#..##.....#.#\n.......................#......#\n..##.###......#.#.............#\n....#...........###............\n##...##.....#.......##.......#.\n...#..##..##..#.#.###..#......#\n........#........#.#..#..#.....\n.#......#....##..........#...#.\n.##...........##....#..........\n.#..#....###.......#....#..##..\n.....###..........#....#.#.#...\n...#....###.#.#......#......#..\n#.#.##.#.....#..#........#...#.\n...#.##.........#..#.....#.....\n.##...##......##...###...#.....\n...#.....#.##..#...#..#........\n........#............#.#.#..##.\n###...#.....#...#..#........##.\n##...#..#.....#.#....#.#.#.....\n#..##.......#...#.#...##..#....\n#...#.##.....#.#..#.##......#.#\n..#......#.#.#.##.##..........#\n..#.##......#.#.#..##..........\n....#..#....#..#..............#\n..........###.....##..#........\n...#.....##.....#..#.#..#...##.\n.#..##.#..#....#.#......#.##...\n...#.....#..#.#...#..#.....#.#.\n#...#.#......##...#..#...#....#\n..#.......##...#..#.......#...#\n#.....#...........##.#.........\n.#......##.....####...#.......#\n........#..#.....#.......#..#..\n....#.#...##..##...#..#....#...\n#.#......#...#.#.###.....#.....\n..##...#.#........#.##....#.#.#\n.#....#......#.#...###.#.......\n.......#.#...##....#.#....#....\n.....##..##...#..#.#.....##..#.\n.##..#.#.#....##.#...#.....#...\n.#..#..##....#.##.......#...#..\n....#.##...#..##......#.....#..\n.#..#....##....#...............\n..##...#.....###...............\n..............#.#.##........#.#\n.#.#....#....#...#.#........#..\n.##...#...#.#....#....#.#.....#\n#..............#......#.####.#.\n......#...........#..#.....##..\n#.#..##.##.....#......#..#.#..#\n##.##..#.##.#.............#...#\n...#..#......#....#............\n........###.#.#..#...#.....#.##\n..#.......#.##.........#..#....\n...##.#........##...#.#.##..#..\n...#..#......#...#....#........\n...........#..#..#...##...#....\n...#.....#....#..####..##.....#\n.......#..#..#......#.........#\n#......#........###.....##....#\n..#..#..#.#.#....##...##......#\n#.#..#..###.#..#.....####......\n.#................#####....#...\n.#.........#...#.......#......#\n..#.......#######........#.....\n..#........#.....#..#...#..#..#\n.#..#.#..#....#.#..##...#..#.#.\n..#...........#.#...#.#.##.....\n...#.#.#....##.###....#...####.\n.....#..#.....#..#.#.........#.\n......##...#...###............#\n..#.#......###..####..#......#.\n###.##.#..#......##.#..##.....#\n....###...##............#.#....\n..#.....##...#...##....#...#...\n#.....#.....#...#...#.#..#.....\n####..........##.#.#..#.....##.\n...#..........#...#...##..##.#.\n..........#.........#.#..#..#..\n#....###.....#.#...#.......##.#\n#..#.##.....#..........#...#...\n...#.#.###.......##..#.....#...\n#...#.#..#.............#..#.#..\n#........#.................#..#\n..#.#....#.#..##.#...#..#....#.\n#...#..........#...###....#...#\n......#.............#....#....#\n#.#.......##.......#.#....##..#\n##...#....#.............#..#...\n........#...###.##.#..###.#...#\n...##...#..#..#...##..##......#\n..#.......##....#.#.##....#....\n.....#....#..#.#...##.#.#.....#")


(def small-input
  "..##.......\n#...#...#..\n.#....#..#.\n..#.#...#.#\n.#...##..#.\n..#.##.....\n.#.#.#....#\n.#........#\n#.##...#...\n#...##....#\n.#..#...#.#")
