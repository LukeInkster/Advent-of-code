(ns advent-2020.day-19
  (:require [clojure.string :as string]))


(defn parse-rule
  [rule-str]
  (let [[id matcher] (string/split rule-str #":")
        options (if (string/starts-with? matcher " \"")
                  (ffirst (re-seq #"[a-z]" matcher))
                  (mapv (fn [part] (mapv #(Long/parseLong %) (re-seq #"[0-9]+" part))) (string/split matcher #"\|")))]
    [(Long/parseLong id) options]))


(defn decode
  [input]
  (let [[rules-str messages-str] (string/split input #"\n\n")]
    {:rules    (into {} (map parse-rule) (string/split-lines rules-str))
     :messages (mapv seq (string/split-lines messages-str))}))


(defn solve
  [rules rule message]
  (cond
    (char? rule) (when (= rule (first message)) [(rest message)])
    (number? (first rule)) (if (= 1 (count rule))
                             (solve rules (get rules (first rule)) message)
                             (mapcat (partial solve rules (rest rule))
                                     (solve rules (get rules (first rule)) message)))
    (sequential? (first rule)) (mapcat (fn [sub-rule] (solve rules sub-rule message)) rule)))


(defn part-1
  [input]
  (let [{:keys [rules messages]} (decode input)]
    (count (filter (fn [message] (some empty? (solve rules (get rules 0) message))) messages))))


(defn part-2
  [input]
  (let [{:keys [rules messages]} (update (decode input) :rules
                                         #(assoc % 8 [[42] [42 8]]
                                                   11 [[42 31] [42 11 31]]))]
    (count (filter (fn [message] (some empty? (solve rules (get rules 0) message))) messages))))


(def small-input
  "0: 4 1 5\n1: 2 3 | 3 2\n2: 4 4 | 5 5\n3: 4 5 | 5 4\n4: \"a\"\n5: \"b\"\n\nababbb\nbababa\nabbbab\naaabbb\naaaabbb")


(def large-input
  "76: 125 57 | 102 58\n6: 57 30 | 58 123\n62: 58 58 | 57 58\n90: 122 57 | 87 58\n82: 57 58 | 57 57\n118: 102 57 | 125 58\n7: 103 57 | 77 58\n130: 27 58 | 53 57\n101: 58 107 | 57 117\n31: 55 58 | 81 57\n114: 123 57 | 62 58\n48: 103 58 | 94 57\n105: 58 113 | 57 20\n100: 57 88 | 58 35\n127: 121 54\n80: 54 58 | 72 57\n19: 5 58 | 102 57\n28: 95 57 | 23 58\n43: 30 58 | 123 57\n119: 58 71 | 57 33\n44: 94 58 | 24 57\n72: 58 58\n35: 109 57 | 106 58\n85: 127 58 | 132 57\n25: 57 30 | 58 102\n42: 119 58 | 111 57\n86: 58 5 | 57 125\n54: 57 121 | 58 57\n88: 58 97 | 57 129\n71: 110 57 | 46 58\n67: 94 57 | 125 58\n12: 5 58 | 62 57\n112: 58 70 | 57 69\n123: 58 57\n52: 10 58 | 48 57\n122: 14 58 | 68 57\n68: 82 58 | 94 57\n23: 57 54 | 58 24\n64: 58 54 | 57 72\n89: 41 57 | 28 58\n132: 103 58 | 47 57\n115: 58 133 | 57 49\n116: 58 103 | 57 77\n15: 77 57 | 24 58\n92: 58 62 | 57 30\n4: 58 99 | 57 75\n59: 57 72 | 58 102\n26: 52 57 | 108 58\n58: \"b\"\n14: 58 103 | 57 30\n47: 57 57 | 58 58\n37: 58 82 | 57 125\n32: 125 57 | 123 58\n95: 123 58 | 123 57\n83: 57 36 | 58 79\n128: 65 58 | 32 57\n125: 57 58 | 58 57\n11: 42 31\n65: 62 58\n75: 58 1 | 57 67\n30: 57 57\n102: 121 121\n0: 8 11\n111: 50 57 | 93 58\n113: 57 126 | 58 40\n129: 25 58 | 29 57\n45: 5 57 | 94 58\n104: 24 121\n24: 58 121 | 57 58\n49: 57 12 | 58 6\n17: 57 123 | 58 54\n3: 74 57 | 131 58\n94: 57 57 | 58 57\n98: 57 86 | 58 2\n13: 34 57 | 78 58\n21: 57 98 | 58 120\n107: 86 58 | 17 57\n57: \"a\"\n9: 57 112 | 58 90\n40: 57 104 | 58 45\n38: 58 94 | 57 30\n106: 57 63 | 58 76\n97: 57 60 | 58 116\n96: 57 77 | 58 72\n41: 63 57 | 19 58\n63: 24 58 | 62 57\n78: 57 47 | 58 103\n131: 30 57 | 62 58\n77: 57 58\n55: 57 9 | 58 100\n69: 96 58 | 43 57\n36: 72 57 | 123 58\n33: 58 101 | 57 26\n53: 58 47 | 57 94\n70: 38 58 | 37 57\n20: 84 57 | 13 58\n2: 57 123 | 58 72\n84: 58 16 | 57 66\n34: 58 5 | 57 62\n56: 85 58 | 3 57\n126: 15 57 | 59 58\n87: 57 80 | 58 51\n93: 58 61 | 57 4\n99: 58 92 | 57 16\n110: 57 83 | 58 124\n10: 57 24 | 58 62\n27: 57 30\n29: 54 57 | 103 58\n103: 57 121 | 58 58\n46: 57 18 | 58 130\n50: 89 57 | 115 58\n79: 57 5 | 58 103\n1: 123 58 | 77 57\n61: 57 128 | 58 39\n109: 116 58 | 96 57\n66: 82 57 | 47 58\n117: 53 58 | 91 57\n124: 118 57 | 7 58\n22: 77 57 | 125 58\n39: 58 66 | 57 44\n51: 58 77 | 57 47\n73: 57 56 | 58 21\n60: 77 57 | 82 58\n91: 24 58 | 123 57\n16: 30 58 | 82 57\n120: 22 57 | 64 58\n81: 57 105 | 58 73\n133: 58 114 | 57 44\n18: 57 60 | 58 22\n8: 42\n108: 58 10 | 57 118\n74: 30 57 | 77 58\n121: 58 | 57\n5: 57 57 | 58 121\n\naaaabbaaaaababbaabbbbbbbabbbbaabbabaabbbbbbbaaba\nababaaabbbabababbabbbbba\nbbbbaaaaabbbababaaabbbaa\nbbbbbaaaabbbababbaaaabab\naaabaababbabaabaaabababaabaaaaabbbbabbba\nbbaaabababbaabbbbabaaababababaaaabbbaaba\nbbbaabbabaabaabaababaaaaabaaabaabaabbbabbaababbb\naaaaaabbabbaabbbbbbbaaaaaaaaabab\nbbaaabbbbaababaabbbbbbaabbbbababbabbabaaaabaababbaaaaabbaabaaaba\nababbbbbabbaabbbbbbbbaab\naabbabaaaaabbaabaaaaaabb\naaabaabaaababbabaaabbaba\nbbbaaaabbbbbaaabbababaabaaaaabba\naaaabbbbaaabaabaaaaaaaabbaabbaaababbbbbb\nbbbbbbaabbaaababababbaaabbabbbaabaaaaaaa\naaabbaaaaabababaaababbbbabbbbabbbabaaaabbbbaabbb\nbaabbbbbaabbbabaabbaaabbbaaaabaababaabbaabbabaaa\nabbaaababaaabbbaaabbbababbaabbbb\nbbbaaababbbbaaabbaabbbaaaaaabababbaabaaaabbaaaababbabbaa\nbbaaaaabbbabbabbbbabbbaa\nbaabababbbaaababbabababbabaaabab\nbabbababbbaaababbbaaaaaabababbbbabaabbaababbbbaabbbaabab\nbababbbbbbaaaaaabaabbbbb\naabaaaabbabababbabaaaabaaabbaaaabbabbbbbbbbbabaaababbabb\nbaabbaabaababbabbabbbaab\nabaaabaaabbbabababbababbbaaaaaab\nbabbaaabaabababaabaabababaaababa\nbbbaaaaaaaabbbababaaabab\naaababaaaabaabbbaabaaaabbbababbabababbabaaabbaabbbaabbababbaabab\nabbbaabbbabababbbabaabaabbaabbbbabaabbbb\naaaaaaabbaabaabaaabbaaab\naabbabbabbabaabbabaababaaaaaabaa\naaabbaabbabaabaababbbbaa\nbaabaababbabbaababbabaabbbabbaabaaabbabbabbaaabb\nbabbbbabbaababaababbbbabbbbaabab\nbbaaaaaaabbbbbaabbbbbaabbaaaabbb\naabbbbbbaabbabbabbbbaaaabbbaaaaaabbbaabaabaabaaa\naaabbabbbaaababbaaabaaaabbbaaaaaabbbbbabbababbba\nababbaaabbbabaabbabbbbabbababababababaabaabaaabb\nbabaaabababaaaaaabaaabbabbaaaababaababbb\nbbbabaabaaaaaaabaaabbaaabaababbb\nabbaaaaaabbaaabababababababaaaaabaabbbbbabbabbba\nabbbaabbbaabaabaaaabbbabaabaabba\naababbaabbaaaaaaaabaabbbbbababaaabababaa\naaabbabbbabaaababaabaaab\nbbaaaabbaaabbabbbbbabaababbbbabaabbabbba\nbababaaabbaaaaaabaaaabba\nbaaabaaabaaabbbbbaaaaaaa\nbbbaaabaababaabbbbbaabbaaaaaaaabaabbabab\nabaababaaabbaaaaaabaabaaabbbabba\naabbbbbbbaaabbbbaaabaabbbbbaaabaabbaaabaabbbababbabbabba\nbbaababaaabbbbabbbbaaabbbbbbbbbaabbbabbbaaaaabaa\naabababbaaabaaaaaaaaabab\nbabaabbbabaaaaaaababbabaababbbbaaaabbaaabbbaabaa\naabaaaabbbaaabbaaabababbbbbbbabbaabbbaaaaabaababbabaaabbbbababbbabbbbaaa\nabaabbababbababbaaaabbabaaaabbaaaaaabaaa\nbbbaabaaaaabaaaabaababaaabbaabaabbbbabaa\nbabbabbbbabababbaabaabbbbbbabbbbabbbbbab\nabbbabaaaaaabaabaaabbabbabaaaabbabaaabbb\nabaaabbababaaabaaababbaabbabaaabbabaabbbaaaabaaaaababbba\nbababbbbbaabaaaabaabababbbbaaabaaabbbbaaaabbbbba\nababbbbbaabababbaaababaababbbbbaabaabbaaabaaaaabaabbbbba\nbabaabaaabbababbaaabbbabbaababba\nbaaaabbbbbaaaaaaaababbbbaabaabba\nabbababbaabbbbbbbbbbbaba\nbaaaabaaaabbbaaaabababbbbaaabbabaaaabaaaababaaaabbabbbaa\nbaababbaaaaaaaaababbaabaabbaaabaabbbbaababbbabaabbabbaaabaaaabbbbaaababa\nabaaabaaabbaabbbbababbaabaaababbaabababaabbbaaba\nbaabbaabbbbbababbbaaaaabaaaabaababbbaaababababaababbaabaababbaab\nabbbaabbaaaabbaabbaabaab\naabbbaaaaabbbaaaabbaabab\naaaababbabaabbabaaaaabbb\naaababaaaaaaaabbaaaaabab\naaaaaaababbabbababababaa\naaabaaaabaaababbabaaabaabaaabaaabbabbbaaaaaaabaa\nabbbababaabaabbbabaabababbaaababbaabbbaababbbaab\nbabaaaabbbbbbbbabbbaaaabbababaabbabbaaabbbbababbababbababaabbaaa\naaaabbabababbaaaaababbabbaabaaaaabbaabab\nbbabaabbaaababaabbaabbbb\naabaabbbbbabbabaabbbbbbbaaaabaababbaaabaabbabbbb\nbabbabbbaaaabbaabaabbaabbbbbababbbaabbbaaaabbbbababbbaba\nabbbbbbabbabaaaababbaabaabababbabbbbbababbbbbaababbbaaaa\nababbbbbaaaababbbabbabbbabaababbbbababbabbbaababaaabbbbb\nbaaaaaaabbaabbababababbabbbbbaba\nbbaaabbbbabbaaaabbbbbaaabaabbaaa\nabaaaaaaababbbabbbbbabba\nbabababbabbaaaaabbabbaabaabbbbaaabbaabba\nbbabaaabbababaabbbbabbba\nabaaabbaabbaabbbabbaaaaabaabbaabaabbaabb\nbabbaaabbabbbbbaaabaaaba\nbabababbbbbbbabbbababbba\nabbbababbababaaabbbbababbabbbaba\nbbaaaaabbaaababbbbbbaaabbabaabbbabbabbaa\nbbabaaaaabaaaabbbaaaaaba\nbabaabaababbbbbaaaaaaabababababbaabaabaaabaabbbb\nbabbabaaaabbabbbbaabbbab\nbbabaaabbbbbaaaaababababbaababaaabaabbbaabaaabbb\nbababaaabbabbaabbabaaaaababbabbaabbabbba\nabbaabababababbbabaaabbb\nbbabbbaaaaaabbbbbbbaaababbabaabaaabaaabbaabaabaa\nbaabbaabbabbbbabbaaabaab\naaaaaaabbbbbababbbbbababbabaabbabbbbbbbb\nbaabaaaabaabbbbabbaaabbababbabaababaaabb\nbbaaaaaaabaababbbbbaabaababbaaba\nbbbababaaababbaababaaaabbbaabaabbaabbbbb\nabaabbabababaaaabbbaabbabaababbbbabbabba\nbbbabababbbbbaaabbbbaaabaabbbbba\nabbaabbbbbbbababaaaabbbbabbababbbbaabbab\nabaaabaabbabbbaaaabbabbbbbbaabab\nbabaaaaabbabaaaabbabbaaaababababaababbabbabaabba\nbbaaabbbbabaaababbabbabaaaaaaababababababaaaaabbabbabbabbaabbbaaaaaaabba\nabaaabaaaaabbaabababaaabbaababaababaabbabbbbbbababbbbaba\nbbababbababaaababbabbbba\nabbbabbaaababbaabbabbaaaaaabaaaababaabab\naaababaababaabaaaaababbbabaabaaa\nbbbbbbaababbaaabbbbaaabaaaaaaaabbbbaaababaaabbab\nbabbbbbaaabababbababaaaababbbabbaabaabba\nbbaaababbbabaababaaabbaabbabaaaaaaaabbaabaaaaabb\naabbbaabbbabaababaabbaabbaababba\nbbaaababbabbbabbbabaabbbbbababbb\naaababbaaaaaaababbbaaabbabbbaaabaabbbbaaaabaabab\naaababaaabbbabababaaabbabbaaabaaaaabbbba\nbbaaaaaaabbabaabbbbababaaaaabbbbaabaaabb\nbbabbbababbbbbbbaaaabbaabbaabababaabaabb\nbabababbabaaabbabbbabbbb\nbbabbaabababaaaaaabbabaabaabaabaaabbaaab\naaaaaaabbbabababbbaaaaba\nbaababaabbabbababaaaaaab\nababababababababbbbbbabbabaaabababbbbbaa\nabaabaabaabaaaaaabbababaabbbabbb\nbabbbbabbababaabbaababba\nbbabaaabbaababaaaaaaaaaa\nbaaabbbbbbbababaabaababaaabababbabbaababababaaba\nabbababbbabaaaabaaaaabba\nabaababbaabbbaaabbbabbbababbbbbaabababababbbbbabbbbabaab\nbbabbbaabaaabaaaaaaaaabbbbaaaaabbbbbbaab\nabbbbaababaabbababbbaaabbaabbbab\nabbbabbaabbbababbbbaaababababbba\nabbaabbbababaabbabaaaabaabaaaabbbabbaaba\naabbbbbabbaaaabbabbbbbababaabaabbabbabbbabbaaabbbaabababababbbbaaabbababbbabbbba\nbbaaabbaabaababbababbaba\nabaaabbaabaaabaaaaabbabbbabbbaab\nababababbbabaabbabaabaab\naababbabbababbbbaababaaa\nabbaaabaaaabbaabbbbbbaab\naababbbbabbaabbaaabaaaaaabaababbabbbbbbbbabaabbbbbabbabb\nababaabbaaaabaabababbaaaabbbababbbabbbbb\nabaabbabbababaaabbbabababaabbabbbbaaaaba\nbbbaabbabbabbbabbabaaaaaaaaababbaaabbaabbababaaa\naabbabaaabbbabbabaababababaaaababaababaabaabbbaaabaabbaaabbabbba\naaaabbbbbaaababbbababaabbaaaabbbbbabababbaaaaabb\nbaaaabbbbbabaaaaaaababbb\nabbbbaabaaabbbbbbababaaaabaabbbbbbaabaaabbbabbabbbbaaaabaabbbbabbababbbaaabbbabb\nbbaaaabbabaaaabbabbaaababbbabaaabaaabbba\nabbababbbbbaabbaaaaaabba\nbabbabaabbbbbabbaaabaaab\nabaaabbaaaababaabbaabbbb\nabaabbabaaabbaabbaabababbbbabaaaabababba\nababababbabbbaaaababbabb\nbbbbabaabbbbbbbbbabbbabbbbbbabaa\nbabaaaaaaabbabbababaabaababbabba\nbbaaabbabababaabaaaaabab\nabbbaaabaabaabbbbabbaaababbababbbaabaaab\nabaaabaaaaabbabbbbbaabaaababbbbbaabbbbba\naabababbaaaabbbaaaabbbba\naabbbaabbbbaaabbbbbaabbaabababaa\nbababbabbbabaababbbaaababababbaaaababbaabbbababb\nbbbababaaababbabbabbbaba\naababababababbaababbbaba\naababbabaabbabbbaabaaaabaabbbabb\nbbabababbababaaaaaababbabbbaabbb\naababbabbbaaaaabbbabbbba\nbbaaaaabbaabaababaaabaaaaababbabbbbbaabbbaabaabbaaaaabbb\nbaabbaabbbbaaabbababababbbaabbbb\naaaabaaaaaabaaababaababbabbbbbbbababababaaabbbbbaabaaaba\nabbbababbababbaabababbba\nabbbbbbbaababbabbabbbaaaabaaaabbbaaabbbbbbaaabaaaaaaabbababbbbaa\nbabbbbbababbaaaaaaaaabaa\nabbbbbbaaaaabaabbaaaaabb\naabaaaabbabababbbbaaababaabbbaabbaabbaaabbaabbaabbbbabaa\nbaaaabbbbaaabbbbaabbbaabbaabaabaaaaabbaaaaaaabaa\naaababbabababaaaaababbbbabababba\nbbabbababaabaabaaabbbbbbababaabbabaaaabbabbbbbab\naababbabbbbaaaabbbaababaaababbaabbbbbaba\nbababbabbbbbbbaababbbbaa\nababababaaaaaabaabbbbbbaaababbaabaaabaaaaabaaabb\naabbabbbababaaababaababbaababaaa\nbbbaabbabaabbbbabbbaabbabaaaaaaa\naabababbabbaaabaaaabaaaaaaabbbabaabbbaba\naaabbaabbbbabaababbaaaab\nbaabbbbaaaaabaabbaaaaaaa\naaabbaaaabbbabaaababababbbabbbaabbbbaaaaabbbbaaa\naabbbaabbbbbbabbabaababaaaabaabaabbaaaaa\nbabbabaaaabbbbbbaaabababbbbbbaab\nbbbbbabbbababababaaabaaaabaabbbbabaaabab\nbabbbbbabbaaababbbbabbaa\naaaaaabbbabbbbabbbaaaaabbbbaaaabaabaabaabaababbb\naabbbaaabbbbaaaaabaabaaa\naabababbbababbabaaaaabba\nbbbbababbbaaaaaababaabba\naabbaaaaaabbabaaaaaaaabbbbaaabbabbbbbbab\naaaaaabbbbbbababbaaabbba\nbbaaaaaababbababbbaaabaa\naaabbaaabbabbbababbbbabbbabaaaaaabbabbababbbbabaabaabbba\nbabaabaaaaababaabaabbaba\nbbabbabaaabbbbabaaaaaababbbbaaabaabaaaababbbbbab\nbbababbaabaababbbabbabbbbbaabbba\nbaaabbaaababbaaabababbabaabbaaaabaaaaaaa\nabaaabababbbaaaaaaaaaabbbababbbabababbab\naaaaababaaabbbbbabbbbbab\naaaabbbabbaaaaaaaabaabaa\naabbbbbbabbaaababbaaaaaaaabbabbbbaabaabb\naabbbaabaaabaaaaaabbbbaabaabbaaa\nababbaaaabbbababbbbababb\nbabaabbbbaababbbbabbaaaaababbabababaaaabaabaaabaabaabbbababbbabb\nbaaaabbabbbbabbbbababbbbbbabbbaabbbbaaaabbbabaaa\naaabaaaaaaabaababbbbbabbbaababbaaabbaaba\nbbabbaaaababaaabbbababaaaaaaabaaaaaaababaaabbbba\naaaabaabaabababbabaabbbb\nbbababbaaababbabbabababaaabbaaba\nabaaaabbbabbabaabbbbbbab\nbabaaaababaababaaabbabbbbbbbabba\naaaabaabaaabbabaaaabaaaaaabbbbaaaaaaaabbbabaabbbababbbbb\naaababaababaaabaabbaabbbaaabaaaababaabbbbaabaabb\nbaababaabbbbbbbababbaaabababbaaaaaaabbaabbabaabbbaaaaabbaabbbbba\nbbabbaaabbbaaaabababbbba\nbbbbaabbbabaaaaaaaaaaababaabaaaabaabbbabbbaababbbabbbbbbaabaaabb\nabaaaabaaaaabaabababaaaabbbbaaab\nababaabbbbbbababbabbbbababaaaaaaabbbaaaa\naaaabbbbabbbbbbaabbbbabbabaaabbb\naabaababbbbbabbabbaaabaaabbaaaab\nbababbabbaaaabbbabbabbab\nababbbbbbbbaabaaababbbbbbbaababb\naababbaaaaaabbbbaabbaaaababababbaabaaaaababbbbbbaabbbabb\nbbaaaabbabbbbbbaaaabbaabaabbabab\naabbabbaaabaaaabbaababababaaabbb\nababababbbaaaaabaaaabbbaabbbbbbabaabababbabaaababbaabbbabbaabbaa\naabbabbaabbababbabbabaabbabbabba\nbaaaabbbabbabaabaaabbaabbaaaabaabaaabbba\nbbbbaaabbabaaabaababaaaababbababababbaaababaaabbaabbbabbababbbba\nbbbabaabbbbaaabababbaaabababbbbaabbababa\nbbbaabaaaabbbbbbababbbbbababbbabbbabbbbabbbabbaa\nbabbababaaaabbbbabbbbaaa\nbbabbbabbbaaaaaaaabaaabb\nbbabababbbabaaabbaabbbbaaababaaa\naabaaaabbbbaaaaabababbbbabbaabba\naabbbbbbbabaaaaabaaaabaa\nbbaaaaaabbbbbabbbbaabbba\nbababbbbbabaaabbaaaabbba\nababaaabbababaabababbbbbabbbaaabbbaabbba\nbbbbbbbaaaabbbababaaaaab\naaababbababbababbabbbaaaaaababababaaaababababbabbabbabaabaababbabbaaababbbabbbab\nbabbababbbabaabaabbbaaaa\nbabbabaaaaaabbabaababbba\nbabbaaabbabaaaaaaaaabbbbbbbaabbaaababbba\naaabaababaabaaaaaaaabaabaababababbaabbba\nbbbaabbabbbaaaaaaabbbaabbbaaaaababaaaaaaaaaabaaaaaabbbba\nabbbabbabbababbababbaaba\nbbbaaaaabababbaabbbabaaa\nbabbabbbabbaaabaabbbaabbaabbbbaaaaabbabbaaabaababaabbaaa\nbababbbbbbabbaaaabababaa\nbbabbaabababababbaaaabaa\nbabaabaabbabaabbabbbbbbbababaaaaaabbbbbbbbbbababbaabbaba\nbbaaabbaaaabaaaaabbaababaabbabab\nbbbaaaaaabbbabbaaababbba\naaaabbaaaabaabbbbabaaaabbbbbbbbb\nabbababbbbabbaaabaabaaab\naaababbbabbbaaabbbaaabbbaababbbbbabababaaababababbaabaab\nbbabbbbaababbbaaabbbbabaaababaaa\nbbbaabaaabbbbabbbaaabaaaaabaaaabbbbbaababbaaabaaaaaaaaaa\naaabbbabbbaaababbbabbaaabaaabbaaaaabababbaabbbab\nbbabaabbaabbbbaaaabbaaaabaababbbabaabaaa\nbaaabbbbbbaaabbaabbbbbbaaaabaaab\nbbbaaabbabbaaaaabaababbb\naabbabbbaaabaabbbabababbbabbbbabbbabaaabaaaaaaaaaaabbbba\nbbbaabbaaaaabbbababbbbaa\naaaaaaabbbaaababaaabaabababbbaba\nbabababbbaababababaaaabaaaabbbaa\nbbbaaaaaabbbbaabaaabaabbbbbaaabb\nbbbbbaaabbbbbbbaaaaabbaaaaaabaaa\naabababbaaabbbabbbabaabbbaaabababaaaaaaa\nbababaaabbabbbaabaabbaabaaaabbbbbaaababbbbabbabbbaababbb\nbbbbbabbaaabbaabbbaababb\nbbaaaabbaaabbabbbbabbbaababbbaabbbbbbbab\nababaabbbbabbaabbaaaaaaa\nabaaaabaabaababbbababbabaabaababaaaaaaaa\nabbbabaabbabababbbbaaaaaabbaabab\nbbbbbabbaabbbbaaabbbbbba\nbbaaaabbaaaababbbbbbbabbbababbbbaabbabaaaaabbbbbbabaabba\nbbbaabaababaaaabaaabbbba\nbbababbabbbbabbababaababbbabbbbbaabaabbaabbbabab\nabbbabbabbabaabbbaababaaababaabbbbaabaaa\nbababaaaaabbbaabbbbbbaabbaabbabb\nabbbbbbaabbaaaaaaabbaaaaaabbbaaababaababbbbabbba\nbbbabababbbaaabbabbbaaababbbabbb\naaaabaabaabbaaaaaaaaaabababbaabb\nbbaaabbbababaabbbbbbbaaaababbabaaabbbbba\nbbbaaabbaabaabbbaabbbbaaaababbbbabbbaabbbbaabbba\nababaaabbbabbbabaabababbabababaabbababaa\naabbabbbbabbaaababbbbbab\nabaaabbabababbababbaabbbaaaabbabaababbaabbababaaabababbabbbbbbbb\nabaabaaababbaabbbbbabaabbabbaabbabaabbaa\nababbbbbaaababaaaababaaa\nabaaaabbaabbabbaaabbaaba\nbaabaaaabbbbababaabbabaaaababbaaabbabbbaabaabbaa\naaabaababaaababbaabbabbbbbbaabbb\nabbbababbbabababbaabaabababbabababbbabbaaaaaaaaabaabbabb\nabaaabbaaaaaaabbaaaabbaaaaababbababbabaabbaabbabbaabaabb\nbbbaabaabbaaaaabaaabbabbaaaababa\nbababbaaabbabbabbaaabbabbabaaabbaaaaabba\naabaabbbbaabbbbabababaababaabbbbbbbabbba\nbbaabbbaabaabaaabbaabbbb\nbababababaaaabbbbbaabbab\nbbbbbabbaabaabbbbababbaaabbbaababbbbbbbb\nabababaabbbbaaaababaaaaabbaaabbbabbababbbabaabba\nabbbbabbbaabbbbaaabbbaababbbabbabaaaabaaaababaab\nabaaaaaabababbaaaabbaaab\nbbaaaababbbbbbbbbaaaabab\nbbaaabbbaababababaabaaaaabaaabaaababbbabaabaaaababbabbbabbbbabbbababbbbaabbabbab\nbbbbaaabbbbabbaaaababaaabababaabbabaabababbbbabbbabbbabbabaabbabbbbaaaaa\naababbabababbbbabbaabbbbbbaabaaaaabbaaabbaaaababbabbabaaababaaaa\naabbbbbbbababbabbbaabaaaabaaaaaabbbbababaaabaabaaabbbbbbabaabbbbaaababbbbaaaabba\nbaabbbbaaababbbbbbbbaaababaaaaabaabaabab\nabaaaababbbbbbbaaaaaaabbbababbaaabbaabab\nbbbbaaaaabbbabaaaaaaaaaa\nbbbabaabbababbbbaabbabab\nbbabaaaaabbaaabaabbaabba\nbbabaaabbaabaaaababababaaaabbbbbbbaababb\nabbbbaaababaabaababaabbbaabbbbbbbabaabbb\naabbbaababaababbaaabababbababaabaabaaaaa\nbaaabbbbaabbabbaabbbabbb\naaabbabbbaaabbaaaabbaaaabaabaabb\nabaaabbababbaaaaabbbaaaa\naabbabbaaaabbabbaaabbbba\nbaaabaaabbbbabaabbbabbbbabaaaaababaaabaaabbbbbbaababbbbbbbbbabbaabbabbaababbaabababbaaba\naaabbabbbbbbaaabaaababbbbabbbaaaaaabbbba\naaabaaaaaabbabaaabaabbabaababbbabaababbb\naabababbabaababababbbaba\nbbbbaaaabbaaaaaababaabbb\nbaabaababaaaabbbabbbbaabbaabbabb\nbaaaabbbaaaaaabaabbbaabbbabaabaaabbaaaab\naaabaabaaaabbabbbbaabbbb\nbbbaaaaaababaaaababaabaabbbaabaababbaaaabbaaaaaaaabaaabb\nabaabababbbaabaabbaaaaabaabbabab\naaababaabababbaabbbbbaaabaaabbbbbabaababbaabbaba\naaaabaababaabbabaaabbaaaababaaabaaabaabababbababaababaab\naaaaaabbaaabbabbbaabbbab\nbbabbaabbbabbaabbbabbaaabbbbbaba\nbaabbbbaaaaaaababbbbbbbaabaabbbaaabbaabb\nbbaaababababaaabbabbbaba\nbaaabaaabbbaaababbabbbaaaabbabaaabbabbab\nbbaaabbbaaabaabbbaabbabb\nbbbabaabaabbbbbbbabaabab\nbabbaaaaaaababbabaabaaaaababaaabbaabaabababababaaaaaabaabbaabbba\nbbabbaabbaaabaaabaabaabbaabbabab\nbabbaaabaaabaaaabaaabbbbaababaaababbbbaa\nabbaaaaababbbbbaabbaabaa\nbabbabababaaaabbbbbabaaa\nabaaabaabbaaabbaaaabaabbaabbbabaaaaababa\nbbbbabbbabbaabbabaaabbbaabbababbbabbbaabaabbababaabbabaabbabbbaaabaaabbbbbbabbaa\naababbabbbabaababbabaaab\nbaabbbbabbaababaaabababbaaabbabbaaabaabbaaabbaaabbabbbbbabbbbaaa\nababababababaaaabbbbabba\naabbbaaaaaababbbbbbaabaaabbbabababbaabbbaaaaabaa\nbababaabbabbaaabbbbbbaba\nabaaaabbbababbbbabaaabaaabbaaaab\nbabbababbaabbaabaaababaabaaabbaaaabbaaabbbababbbbabbbbaa\naaaabbababbbaabbbababbbbaaababbbabbaabab\nbbaaaaaababbbbbaaabbbbbbabbbaaababaabababaaaaaab\nabaaabbaaababbabbbbbbaaaababaaaaaabbaaab\naaababbabbbaabaabababbaabbabbbababbaaaabbaaaaaabaaaaabbbbabbaabb\nbababbaaababbaaababbabaaaababbba\nbaabaabaabaaabaaaabbbaabaaaabaaabaaabbab\naaaaaabbabbababbbbaabaab\nbaabaababbbbaaaababbabab\naaaaaabbaaaabbaaaaaaaababaaaabaabbababbb\nbbabaaababaaaabaababbbbbabaabbba\naaaababbbabaaababbbbaaba\nbabbaaabbaabbaabbbbbababbabaabaaabbbbaabaabbaaba")
